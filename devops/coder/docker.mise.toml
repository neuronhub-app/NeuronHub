# $schema: https://mise.jdx.dev/schema/mise-task.json

["docker:build"]
    dir = "devops/coder"
    env.DOCKER_REGISTRY_URL = "{{ get_env(name='DOCKER_REGISTRY_URL', default='ghcr.io') }}"
    env.DOCKER_IMAGE_ID = "neuronhub/coder"
    run = "sudo docker build --tag {{ get_env(name='DOCKER_REGISTRY_URL') }}/neuronhub/coder:{{option(name='version', default='latest')}} ."

["docker:push"]
    dir = "devops/coder"
    env.DOCKER_REGISTRY_URL = "{{ get_env(name='DOCKER_REGISTRY_URL', default='ghcr.io') }}"
    env.DOCKER_IMAGE_ID = "neuronhub/coder"
    run = "sudo docker push {{ get_env(name='DOCKER_REGISTRY_URL') }}/neuronhub/coder:{{option(name='version', default='latest')}}"
