["dev:db-init"]
    run = """
        if [ "$IS_DB_EXTERNAL" = "true" ]; then
            brew install postgresql@17
            brew services start postgresql@17
            createdb-17 $DATABASE_NAME
            psql-17 $DATABASE_NAME << SQL
              CREATE USER ${DATABASE_NAME};
              ALTER ROLE ${DATABASE_NAME} PASSWORD '${DATABASE_NAME}';
              GRANT ALL ON SCHEMA public TO ${DATABASE_NAME};
              ALTER USER ${DATABASE_NAME} CREATEDB;
SQL
        else
            echo "Using docker-compose db."
        fi

        mise run django:migrate
        mise run django:db-stubs-repopulate
    """
